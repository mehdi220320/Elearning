<div class="courses-list-container">
  <div class="list-header">
    <h2><i class="fas fa-exclamation-circle me-2"></i>Gestion des Réclamations</h2>
    <div class="header-actions">
      <div class="search-bar">
        <i class="fas fa-search"></i>
        <input
          type="text"
          class="form-control"
          placeholder="Rechercher..."
          [(ngModel)]="searchTerm"
          (input)="applyFilters()">
      </div>
    </div>
  </div>

  <div class="row stats-row">
    <div class="col-md-3">
      <div class="stats-card total-reclamations">
        <div class="icon"><i class="fas fa-exclamation-circle"></i></div>
        <div class="number">{{ reclamations.length }}</div>
        <div class="title">Total Réclamations</div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="stats-card pending-reclamations">
        <div class="icon"><i class="fas fa-clock"></i></div>
        <div class="number">{{ getPendingCount() +"/"+reclamations.length }}</div>
        <div class="title">En Attente</div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="stats-card treated-reclamations">
        <div class="icon"><i class="fas fa-check-circle"></i></div>
        <div class="number">{{ getCoursesCount() }}</div>
        <div class="title">Concernant les cours</div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="stats-card hackathon-reclamations">
        <div class="icon"><i class="fas fa-laptop-code"></i></div>
        <div class="number">{{ getHackathonCount() }}</div>
        <div class="title">Concernant les Hackathons</div>
      </div>
    </div>
  </div>

  <div class="main-card">
    <div class="card-header">
      <h5>Liste des Réclamations</h5>
      <div class="filters">
        <select
          class="form-select filter-select"
          [(ngModel)]="selectedType"
          (change)="applyFilters()">
          <option>Tous les types</option>
          <option>Hackathon</option>
          <option>Cours</option>
          <option>Les deux</option>
        </select>
        <select
          class="form-select filter-select"
          [(ngModel)]="selectedStatus"
          (change)="applyFilters()">
          <option value="Tous les statuts">Tous les statuts</option>
          <option value="1">En attente</option>
          <option value="2">Traîtées</option>
        </select>
      </div>
    </div>

    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-hover">
          <thead>
          <tr>
            <th>Sujet</th>
            <th>Type</th>
            <th>Utilisateur</th>
            <th>Date</th>
            <th>Statut</th>
            <th>Actions</th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let reclamation of paginatedReclamations">
            <td>{{ reclamation.sujet }}</td>
            <td>
              <span
                class="reclamation-type"
                [ngClass]="{
                  'type-course': typeConcernant(reclamation) === 'Cours',
                  'type-hackathon': typeConcernant(reclamation) === 'Hackathon',
                  'type-both': typeConcernant(reclamation) === 'Les deux'
                }">
                {{ typeConcernant(reclamation)}}
              </span>
            </td>
            <td>{{ reclamation.creator.firstname }} {{ reclamation.creator.lastname }}</td>
            <td>{{ formatDate(reclamation.createdAt) }}</td>
            <td>
              <span
                class="badge"
                [ngClass]="{
                  'badge-warning': !reclamation.seen,
                  'badge-success': reclamation.seen
                }">
                {{ reclamation.seen ? 'Traité' : 'En attente' }}
              </span>
            </td>
            <td>
              <div class="action-buttons">
                <button
                  class="btn btn-sm btn-view"
                  [routerLink]="'/admin/reclamations/'+reclamation._id">
                  <i class="fas fa-eye"></i>
                </button>
              </div>
            </td>
          </tr>
          <tr *ngIf="filteredReclamations.length === 0">
            <td colspan="6" class="text-center">Aucune réclamation trouvée</td>
          </tr>
          </tbody>
        </table>
      </div>

      <nav aria-label="Page navigation" *ngIf="filteredReclamations.length > 0">
        <ul class="pagination justify-content-center">
          <li class="page-item" [class.disabled]="currentPage === 1">
            <a
              class="page-link"
              href="javascript:void(0)"
              (click)="changePage(currentPage - 1)">
              Précédent
            </a>
          </li>
          <li
            class="page-item"
            [class.active]="page === currentPage"
            *ngFor="let page of getPages()">
            <a
              class="page-link"
              href="javascript:void(0)"
              (click)="changePage(page)">
              {{ page }}
            </a>
          </li>
          <li class="page-item" [class.disabled]="currentPage === totalPages">
            <a
              class="page-link"
              href="javascript:void(0)"
              (click)="changePage(currentPage + 1)">
              Suivant
            </a>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</div>

